<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:HaircutHistoryApp.ViewModels"
             x:Class="HaircutHistoryApp.Views.LoginPage"
             x:DataType="vm:LoginViewModel"
             Shell.NavBarIsVisible="False"
             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLight}, Dark={StaticResource BackgroundDark}}">

    <Grid Padding="30">
        <VerticalStackLayout VerticalOptions="Center" Spacing="30">

            <!-- Logo/Title -->
            <VerticalStackLayout Spacing="10">
                <Image Source="icon.png"
                       HeightRequest="120"
                       WidthRequest="120"
                       HorizontalOptions="Center"/>
                <Label Text="Haircut History"
                       FontSize="32"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       TextColor="{StaticResource Primary}"/>
            </VerticalStackLayout>

            <!-- Signing In State -->
            <VerticalStackLayout Spacing="15"
                                 IsVisible="{Binding IsBusy}">
                <ActivityIndicator IsRunning="True"
                                   Color="{StaticResource Primary}"
                                   HeightRequest="50"
                                   WidthRequest="50"
                                   HorizontalOptions="Center"/>
                <Label Text="Signing in..."
                       FontSize="16"
                       HorizontalOptions="Center"
                       TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondaryDark}}"/>
            </VerticalStackLayout>

            <!-- Error/Retry State -->
            <VerticalStackLayout Spacing="20"
                                 IsVisible="{Binding ShowRetry}">
                <Label Text="{Binding ErrorMessage}"
                       FontSize="14"
                       HorizontalTextAlignment="Center"
                       TextColor="{StaticResource Danger}"/>

                <Button Text="Try Again"
                        Command="{Binding RetrySignInCommand}"
                        Style="{StaticResource PrimaryButton}"
                        HorizontalOptions="Center"
                        WidthRequest="200"/>

                <Label Text="or"
                       FontSize="12"
                       HorizontalOptions="Center"
                       TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondaryDark}}"/>

                <Button Text="Continue without account"
                        Command="{Binding ContinueOfflineCommand}"
                        BackgroundColor="Transparent"
                        TextColor="{StaticResource Primary}"
                        FontSize="14"
                        HorizontalOptions="Center"/>
            </VerticalStackLayout>

            <!-- Skip Option (shown during sign-in) -->
            <Button Text="Skip for now"
                    Command="{Binding ContinueOfflineCommand}"
                    IsVisible="{Binding IsBusy}"
                    BackgroundColor="Transparent"
                    TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondaryDark}}"
                    FontSize="14"
                    HorizontalOptions="Center"
                    Margin="0,20,0,0"/>

        </VerticalStackLayout>
    </Grid>
</ContentPage>
